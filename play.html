<script src="games.js"></script>
<script>
// ======== HELPER: GET QUERY PARAM ========
function getQueryParam(name) {
    const params = new URLSearchParams(window.location.search);
    return params.get(name);
}

// ======== LOAD GAME ========
const gameId = getQueryParam('game');

if (!gameId || !games[gameId]) {
    // Invalid or missing game, redirect back
    alert('Game not found! Redirecting...');
    window.location.href = 'index.html';
} else {
    const gameData = games[gameId]; // from games.js

    // Set title
    document.getElementById('title').textContent = gameData.name || gameId;

    // Load game in iframe
    const iframe = document.getElementById('frame');
    iframe.src = gameData.link;

    // Show game container when iframe loads
    iframe.onload = () => {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('game').style.display = 'block';
    };

    // Fallback in case onload doesn't fire
    setTimeout(() => {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('game').style.display = 'block';
    }, 3000);
}

// ======== FULLSCREEN ========
function goFull() {
    const elem = document.documentElement;
    if (elem.requestFullscreen) elem.requestFullscreen();
    else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
    else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
    document.body.classList.add('full');
}

// Remove fullscreen class when exiting fullscreen
['fullscreenchange', 'webkitfullscreenchange'].forEach(evt => {
    document.addEventListener(evt, () => {
        if (!document.fullscreenElement && !document.webkitFullscreenElement) {
            document.body.classList.remove('full');
        }
    });
});
</script>
