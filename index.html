<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_self">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synapse AI - Intelligent AI Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        @keyframes float {0%,100%{transform:translateY(0px);}50%{transform:translateY(-20px);}}
        @keyframes pulse-glow {0%,100%{box-shadow:0 0 20px rgba(59,130,246,0.5);}50%{box-shadow:0 0 40px rgba(59,130,246,0.8);}}
        @keyframes fadeInUp {from{opacity:0;transform:translateY(30px);}to{opacity:1;transform:translateY(0);}}
        @keyframes starTwinkle {0%,100%{opacity:0.2;}50%{opacity:1;}}
        @keyframes typing {from{width:0;}to{width:100%;}}
        @keyframes blink {0%,100%{opacity:1;}50%{opacity:0;}}
        
        .animate-float{animation:float 6s ease-in-out infinite;}
        .animate-pulse-glow{animation:pulse-glow 2s ease-in-out infinite;}
        .typing-animation{overflow:hidden;white-space:nowrap;animation:typing 3.5s steps(40,end);}
        .cursor-blink{animation:blink 1s infinite;}
        .glassmorphism{background:rgba(255,255,255,0.05);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.1);}
        .nav-underline{position:relative;}
        .nav-underline::after{content:'';position:absolute;width:0;height:2px;bottom:-5px;left:0;background:linear-gradient(90deg,#3b82f6,#8b5cf6);transition:width 0.3s ease;}
        .nav-underline:hover::after,.nav-underline.active::after{width:100%;}
        .chat-bubble-user{background:linear-gradient(135deg,#3b82f6,#1d4ed8);border-radius:20px 20px 0 20px;}
        .chat-bubble-ai{background:linear-gradient(135deg,#4f46e5,#7c3aed);border-radius:20px 20px 20px 0;}
        .game-card{transition:all 0.3s ease;cursor:pointer;}
        .game-card:hover{transform:translateY(-10px) scale(1.02);box-shadow:0 20px 40px rgba(59,130,246,0.3);}
        .game-card:hover .play-overlay{opacity:1;}
        .play-overlay{position:absolute;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;}
        .play-icon{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#3b82f6,#8b5cf6);display:flex;align-items:center;justify-content:center;font-size:24px;}
        .loading-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:#0f172a;display:flex;justify-content:center;align-items:center;z-index:9999;transition:opacity 0.5s ease;}
        .loading-dots{display:flex;gap:10px;}
        .loading-dot{width:20px;height:20px;border-radius:50%;background:linear-gradient(45deg,#3b82f6,#8b5cf6);animation:float 1s ease-in-out infinite;}
        .loading-dot:nth-child(2){animation-delay:0.2s;}
        .loading-dot:nth-child(3){animation-delay:0.4s;}
        .parallax-bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;pointer-events:none;}
        .star{position:absolute;background:white;border-radius:50%;animation:starTwinkle 3s infinite;}
        .page-transition{animation:fadeInUp 0.5s ease forwards;}
        .typing-indicator{display:flex;align-items:center;gap:4px;}
        .typing-dot{width:8px;height:8px;border-radius:50%;background:#8b5cf6;animation:float 1.4s infinite ease-in-out;}
        .typing-dot:nth-child(1){animation-delay:-0.32s;}
        .typing-dot:nth-child(2){animation-delay:-0.16s;}
        .cat-btn{padding:8px 16px;border-radius:20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:#9ca3af;cursor:pointer;transition:all 0.3s;}
        .cat-btn:hover,.cat-btn.active{background:linear-gradient(135deg,#3b82f6,#8b5cf6);color:white;border:none;}
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: "#3b82f6",
                        secondary: "#8b5cf6",
                        dark: "#0f172a",
                        "dark-light": "#1e293b"
                    },
                    fontFamily: {
                        'sans': ['Inter','system-ui','sans-serif'],
                        'orbitron': ['Orbitron','monospace']
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen bg-dark text-white font-sans overflow-x-hidden">

<!-- Loading Screen -->
<div id="loadingScreen" class="loading-screen">
    <div class="text-center">
        <div class="loading-dots mb-6">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
        </div>
        <h2 class="text-2xl font-orbitron font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Loading Synapse AI...</h2>
        <p class="text-gray-400 mt-2">Initializing neural networks</p>
    </div>
</div>

<!-- Parallax Background -->
<div id="parallaxBg" class="parallax-bg"></div>

<!-- Navigation -->
<nav class="glassmorphism fixed top-0 left-0 right-0 z-50 border-b border-white/10">
    <div class="container mx-auto px-4 py-4 flex items-center justify-between">
        <div class="flex items-center space-x-2">
            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center">
                <i class="fas fa-brain text-white"></i>
            </div>
            <span class="text-2xl font-orbitron font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Synapse AI</span>
        </div>
        <div class="hidden md:flex items-center space-x-8">
            <a href="#" data-page="home" class="nav-underline active text-gray-300 hover:text-white transition-colors duration-300">Home</a>
            <a href="#" data-page="chat" class="nav-underline text-gray-300 hover:text-white transition-colors duration-300">AI Chat</a>
            <a href="#" data-page="games" class="nav-underline text-gray-300 hover:text-white transition-colors duration-300">Games</a>
            <a href="#" data-page="policy" class="nav-underline text-gray-300 hover:text-white transition-colors duration-300">Policy</a>
            <a href="#" data-page="roblox" class="nav-underline text-gray-300 hover:text-white transition-colors duration-300">Online Games!</a>
<a href="#" data-page="chatroom" class="nav-underline text-gray-300 hover:text-white transition-colors duration-300">Chatroom</a>

        </div>
        <button id="tryAI" class="px-6 py-2 bg-gradient-to-r from-primary to-secondary rounded-full font-semibold hover:scale-105 transition-transform duration-300 animate-pulse-glow">Try the AI</button>
        <button id="mobileMenuBtn" class="md:hidden text-gray-300 hover:text-white"><i class="fas fa-bars text-2xl"></i></button>
    </div>
    <div id="mobileMenu" class="md:hidden mt-4 hidden flex-col space-y-4 px-4">
        <a href="#" data-page="home" class="nav-underline active text-gray-300 hover:text-white py-2">Home</a>
        <a href="#" data-page="chat" class="nav-underline text-gray-300 hover:text-white py-2">AI Chat</a>
        <a href="#" data-page="games" class="nav-underline text-gray-300 hover:text-white py-2">Games</a>
        <a href="#" data-page="policy" class="nav-underline text-gray-300 hover:text-white py-2">Policy</a>
<a href="#" data-page="chatroom" class="nav-underline text-gray-300 hover:text-white py-2">Chatroom</a>
    </div>
</nav>

<!-- Main Content -->
<main class="pt-20">

<!-- HOME PAGE -->
<div id="homePage" class="page-transition">
    <section class="container mx-auto px-4 py-16 md:py-24 text-center">
        <h1 class="text-4xl md:text-6xl lg:text-7xl font-orbitron font-bold mb-6">
            <span class="bg-gradient-to-r from-primary via-purple-500 to-secondary bg-clip-text text-transparent">Welcome to</span>
            <br>
            <span class="typing-animation bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Synapse AI</span>
            <span class="cursor-blink">|</span>
        </h1>
        <p class="text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto">When that stupid English essay is due but Chatgpt is blocked....</p>
        <button onclick="showPage('chat')" class="px-8 py-4 bg-gradient-to-r from-primary to-secondary rounded-full text-lg font-semibold hover:scale-105 transition-all duration-300 animate-pulse-glow">
            <i class="fas fa-rocket mr-2"></i>Start Your AI Journey
        </button>
        <div class="mt-16 animate-float">
            <div class="glassmorphism rounded-3xl p-8 max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-bolt text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Lightning Fastüí®</h3>
                    <p class="text-gray-400">Instant responses powered by advanced neural networks</p>
                </div>
                <div class="text-center">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-shield-alt text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Undetectable Aiü§Ø</h3>
                    <p class="text-gray-400">Undetectable Ai that can do EVERYTHING for you!üòé</p>
                </div>
                <div class="text-center">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-gamepad text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Fun Gamesüòâ</h3>
                    <p class="text-gray-400">Play awesome unblocked games in your browser</p>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- CHAT PAGE -->
<div id="chatPage" class="page-transition hidden">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-orbitron font-bold mb-4">
                <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Synapse AI Chat</span>
            </h1>
            <p class="text-gray-400">Your intelligent AI assistant with superpowers üöÄ</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Main Chat Area -->
            <div class="lg:col-span-2">
                <div class="glassmorphism rounded-2xl overflow-hidden h-[600px] flex flex-col relative">
                    <!-- Animated Header -->
                    <div class="p-4 border-b border-white/10 flex items-center justify-between bg-gradient-to-r from-primary/10 to-secondary/10">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center animate-pulse-glow">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="font-semibold">Synapse AI Assistant</h3>
                                <p class="text-sm text-green-400">‚óè Online ‚Ä¢ Lightning Fast</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="clearChat()" class="p-2 hover:bg-white/10 rounded-lg transition-all" title="Clear Chat">
                                <i class="fas fa-trash text-gray-400"></i>
                            </button>
                            <button onclick="toggleVoice()" class="p-2 hover:bg-white/10 rounded-lg transition-all" title="Voice Mode">
                                <i class="fas fa-microphone text-gray-400"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Messages Area -->
                    <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-4">
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-robot text-sm"></i>
                            </div>
                            <div class="ml-3">
                                <div class="chat-bubble-ai p-4 max-w-md">
                                    <p>üëã Hello! I'm Synapse AI. I can help you with:</p>
                                    <ul class="mt-2 space-y-1 text-sm">
                                        <li>üìù Essays & homework</li>
                                        <li>üßÆ Math problems</li>
                                        <li>üí° Creative ideas</li>
                                        <li>üî¨ Research & analysis</li>
                                        <li>üíª Coding help</li>
                                    </ul>
                                    <p class="mt-2">What can I help you with today?</p>
                                </div>
                            </div>
                        </div>
                        <div id="typingIndicator" class="flex items-start hidden">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-robot text-sm"></i>
                            </div>
                            <div class="ml-3">
                                <div class="chat-bubble-ai p-4 max-w-md">
                                    <div class="typing-indicator">
                                        <div class="typing-dot"></div>
                                        <div class="typing-dot"></div>
                                        <div class="typing-dot"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Input Area with Quick Actions -->
                    <div class="p-4 border-t border-white/10 bg-dark-light/50">
                        <div class="flex flex-wrap gap-2 mb-3" id="quickPrompts">
                            <button onclick="useQuickPrompt('Help me write an essay about')" class="px-3 py-1 bg-primary/20 hover:bg-primary/30 rounded-full text-xs transition-all">
                                üìù Essay Help
                            </button>
                            <button onclick="useQuickPrompt('Solve this math problem:')" class="px-3 py-1 bg-primary/20 hover:bg-primary/30 rounded-full text-xs transition-all">
                                üßÆ Math Solver
                            </button>
                            <button onclick="useQuickPrompt('Explain this concept:')" class="px-3 py-1 bg-primary/20 hover:bg-primary/30 rounded-full text-xs transition-all">
                                üí° Explain
                            </button>
                            <button onclick="useQuickPrompt('Help me code:')" class="px-3 py-1 bg-primary/20 hover:bg-primary/30 rounded-full text-xs transition-all">
                                üíª Code Helper
                            </button>
                        </div>
                        <div class="flex space-x-2">
                            <input type="text" id="chatInput" placeholder="Ask me anything..." class="flex-1 bg-dark-light border border-white/10 rounded-full px-6 py-3 focus:outline-none focus:border-primary transition-all">
                            <button id="sendMessage" class="px-6 py-3 bg-gradient-to-r from-primary to-secondary rounded-full font-semibold hover:scale-105 transition-transform">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar with Stats & Features -->
            <div class="space-y-6">
                <!-- Stats Card -->
                <div class="glassmorphism rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-chart-line text-primary mr-2"></i>
                        Chat Stats
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Messages Sent</span>
                            <span class="font-bold text-primary" id="messageCount">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Avg Response</span>
                            <span class="font-bold text-green-400">0.8s</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">AI Power</span>
                            <span class="font-bold text-secondary">100%</span>
                        </div>
                    </div>
                </div>

                <!-- Features Card -->
                <div class="glassmorphism rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-magic text-secondary mr-2"></i>
                        AI Features
                    </h3>
                    <div class="space-y-3 text-sm">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-check-circle text-green-400"></i>
                            <span>Undetectable Content</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-check-circle text-green-400"></i>
                            <span>Multi-Language Support</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-check-circle text-green-400"></i>
                            <span>Context Understanding</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-check-circle text-green-400"></i>
                            <span>Code Generation</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-check-circle text-green-400"></i>
                            <span>24/7 Availability</span>
                        </div>
                    </div>
                </div>

                <!-- Pro Tips Card -->
                <div class="glassmorphism rounded-2xl p-6 bg-gradient-to-br from-primary/10 to-secondary/10">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-lightbulb text-yellow-400 mr-2"></i>
                        Pro Tips
                    </h3>
                    <ul class="space-y-2 text-sm text-gray-300">
                        <li>üí° Be specific for better results</li>
                        <li>üéØ Ask follow-up questions</li>
                        <li>üìã Request different formats</li>
                        <li>üîÑ Ask for revisions anytime</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

</div>

<!-- CHATROOM PAGE -->
<div id="chatroomPage" class="page-transition hidden">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-orbitron font-bold mb-4">
                <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">üåê Public Chatroom</span>
            </h1>
            <p class="text-gray-400">Chat with everyone using Synapse AI ‚Ä¢ Be respectful!</p>
        </div>
		<!-- Admin Panel (Hidden by default) -->
<div id="adminPanel" class="hidden absolute top-0 left-0 right-0 bottom-0 bg-dark/95 backdrop-blur-sm z-50 p-6 overflow-y-auto">
    <div class="max-w-2xl mx-auto">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-red-400">
                <i class="fas fa-shield-alt mr-2"></i>Admin Control Panel
            </h2>
            <button onclick="closeAdminPanel()" class="px-4 py-2 bg-red-500/20 hover:bg-red-500/30 rounded-lg transition-all">
                <i class="fas fa-times mr-1"></i>Close
            </button>
        </div>
        
        <div class="glassmorphism rounded-xl p-6 mb-4">
            <h3 class="text-lg font-semibold mb-4 text-red-400">Danger Zone</h3>
            <button onclick="deleteAllMessages()" class="w-full px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-all mb-3">
                <i class="fas fa-trash-alt mr-2"></i>Delete ALL Messages
            </button>
            <button onclick="toggleDeleteMode()" id="deleteMode" class="w-full px-4 py-3 bg-orange-600 hover:bg-orange-700 rounded-lg font-semibold transition-all">
                <i class="fas fa-mouse-pointer mr-2"></i>Enable Delete Mode (Click Messages to Delete)
            </button>
        </div>
        
        <div class="glassmorphism rounded-xl p-6">
            <h3 class="text-lg font-semibold mb-3">Admin Stats</h3>
            <div class="space-y-2 text-sm">
                <p><i class="fas fa-users text-primary mr-2"></i>Online Users: <span id="adminOnlineCount">0</span></p>
                <p><i class="fas fa-comments text-secondary mr-2"></i>Total Messages: <span id="adminTotalMessages">0</span></p>
                <p><i class="fas fa-clock text-yellow-400 mr-2"></i>Auto-delete: 30 minutes</p>
            </div>
        </div>
    </div>
</div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Main Chat Area -->
            <div class="lg:col-span-2">
                <div class="glassmorphism rounded-2xl overflow-hidden h-[600px] flex flex-col">
                    <!-- Header -->
                    <div class="p-4 border-b border-white/10 flex items-center justify-between bg-gradient-to-r from-primary/10 to-secondary/10">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center animate-pulse-glow">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="font-semibold">Global Chat</h3>
                                <p class="text-sm text-green-400">‚óè <span id="onlineCount">0</span> Online</p>
                            </div>
                        </div>
                        <button onclick="changeNickname()" class="px-3 py-1 bg-primary/20 hover:bg-primary/30 rounded-full text-xs transition-all">
                            <i class="fas fa-user-edit mr-1"></i>Change Nickname
                        </button>
						<button onclick="adminLogin()" class="px-3 py-1 bg-red-500/20 hover:bg-red-500/30 rounded-full text-xs transition-all" id="adminLoginBtn">
    <i class="fas fa-shield-alt mr-1"></i>Admin
</button>
                    </div>

                    <!-- Messages Area -->
                    <div id="chatroomMessages" class="flex-1 overflow-y-auto p-4 space-y-3">
                        <div class="text-center text-gray-500 text-sm py-8">
                            <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                            <p>Loading messages...</p>
                        </div>
                    </div>

                    <!-- Input Area -->
                    <div class="p-4 border-t border-white/10 bg-dark-light/50">
                        <div class="flex space-x-2">
                            <input type="text" id="chatroomInput" placeholder="Type your message..." maxlength="200" class="flex-1 bg-dark-light border border-white/10 rounded-full px-6 py-3 focus:outline-none focus:border-primary transition-all">
                            <button id="sendChatroomMessage" class="px-6 py-3 bg-gradient-to-r from-primary to-secondary rounded-full font-semibold hover:scale-105 transition-transform disabled:opacity-50 disabled:cursor-not-allowed">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-2" id="chatroomStatus">Connecting...</p>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="space-y-6">
                <!-- User Info Card -->
                <div class="glassmorphism rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-user text-primary mr-2"></i>
                        Your Profile
                    </h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center">
                                <i class="fas fa-user text-xl"></i>
                            </div>
                            <div>
                                <p class="font-semibold" id="currentNickname">Guest</p>
                                <p class="text-xs text-gray-400">Click above to change</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rules Card -->
                <div class="glassmorphism rounded-2xl p-6 bg-gradient-to-br from-primary/10 to-secondary/10">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-shield-alt text-yellow-400 mr-2"></i>
                        Chat Rules
                    </h3>
                    <ul class="space-y-2 text-sm text-gray-300">
                        <li>‚úÖDo whatever you wantüëç</li>
                        <li>‚ùå I am NOT liable for ANYTHING that happens in here(enter at your own cost as if anything happens the creator is NOT involved)</li>
                        <li>‚ùå No spam flooding</li>
						<li>‚ùå Do not post any copy righted material, personal info, or anything important as YOU are held accountable for it</li>
                        <li>‚ùå If you feel like you are being mistreated, just leaveüôè</li>
                        <li>‚ùå Anything that happens here is NOT monitored</li>
                    </ul>
                </div>

                <!-- Stats Card -->
                <div class="glassmorphism rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-chart-bar text-secondary mr-2"></i>
                        Stats
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Your Messages</span>
                            <span class="font-bold text-primary" id="userMessageCount">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Total Messages</span>
                            <span class="font-bold text-green-400" id="totalMessageCount">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

    
           <!-- ROBLOX PAGE -->
<div id="robloxPage" class="page-transition hidden">
    <div class="container mx-auto px-4 py-8 text-center">
        <h1 class="text-4xl md:text-5xl font-orbitron font-bold mb-6">
            <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Online Games</span>
        </h1>
        <p class="text-white-700 mb-8">Steps to get online games to run in 2 min!</p>
	<p class="text-white-700 mb-8">1.Enter this link in the search bar at the bottom of the screen and click "Open in Browser
": https://web.cloudmoonapp.com/</p>
				       
                                      
        <p class="text-white-700 mb-8">2.Sign up with your homeaccount(or make a new account if you feel unsafe)</p>
        <p class="text-white-700 mb-8">3.Click your online game and enjoy! </p>
<p class="text-white-700 mb-8">Info:There are many online games you can play such as Roblox, Fortnite, Clash Royale, etc..
	
	! </p>
        <!-- IFRAME CONTAINER WITH WHITE BACKGROUND -->
        <div class="roblox-embed-container rounded-2xl p-4 max-w-4xl mx-auto bg-white shadow-lg">
            <!-- DROP YOUR IFRAME HERE -->
            <iframe src="https://coursera.gq/" 
                    width="100%" height="600" 
                    class="rounded-2xl border border-gray-300"
                    allowfullscreen
                    sandbox="allow-scripts allow-same-origin allow-popups">
            </iframe>
        </div>
    </div>
</div>

<!-- GAMES PAGE -->
<div id="gamesPage" class="page-transition hidden">
    <div class="container mx-auto px-4 py-8">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-orbitron font-bold mb-4">
                <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">üéÆ Unblocked Games</span>
            </h1>
            <!-- SEARCH BAR ADDITION #1 -->
            <div class="max-w-md mx-auto mb-6 relative">
                <input type="text" id="gameSearch" placeholder="Search games..." class="w-full bg-dark-light border border-white/10 rounded-full px-12 py-3 focus:outline-none focus:border-primary transition-all duration-300">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>
            <p class="text-gray-400 max-w-2xl mx-auto">Click any game to play!</p>
        </div>
        <div class="flex flex-wrap justify-center gap-3 mb-8" id="categoryFilter"></div>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="gamesGrid"></div>
    </div>
</div>

<!-- POLICY PAGE -->
<div id="policyPage" class="page-transition hidden">
    <div class="container mx-auto px-4 py-8 max-w-4xl space-y-8">
        <div class="text-center mb-12">
            <h1 class="text-3xl md:text-4xl font-orbitron font-bold mb-4">
                <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Privacy Policy & Terms</span>
            </h1>
        </div>
        <section class="glassmorphism rounded-2xl p-6">
            <h2 class="text-2xl font-semibold mb-4 text-primary">Privacy Policy</h2>
            <p class="text-gray-300">At Synapse AI, we take your privacy seriously.</p>
        </section>
        <section class="glassmorphism rounded-2xl p-6">
            <h2 class="text-2xl font-semibold mb-4 text-primary">Terms of Service</h2>
            <p class="text-gray-300">By using Synapse AI, you agree to these terms.</p>
        </section>
        <section class="glassmorphism rounded-2xl p-6">
            <h2 class="text-2xl font-semibold mb-4 text-primary">Contact</h2>
            <p class="text-gray-300"><i class="fas fa-envelope text-primary mr-2"></i>support@Synapse-ai.com</p>
        </section>
    </div>
</div>

</main>

<!-- Footer -->
<footer class="mt-16 border-t border-white/10">
    <div class="container mx-auto px-4 py-8 text-center">
        <p class="text-gray-500">¬© 2024 Synapse AI. All rights reserved.</p>
    </div>
</footer>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script src="games.js"></script>
<script>
// ===========================
// Hugging Face AI Config
// ===========================
const HF_API_URL = "https://prisonlike-coessentially-elliot.ngrok-free.dev/generate";

const HF_API_TOKEN = ""; // <- no token needed for your local APIsen

    // ===========================
    // AI Responses
    // ===========================
    var aiResponses = [
        "That's an interesting question!",
        "I'd be happy to help with that!",
        "Great question! Here's what I know...",
        "Let me explain that for you."
    ];

    // ===========================
    // Page Elements
    // ===========================
    var pages = {
    home: document.getElementById("homePage"),
    chat: document.getElementById("chatPage"),
    games: document.getElementById("gamesPage"),
    policy: document.getElementById("policyPage"),
    roblox: document.getElementById("robloxPage"),
    chatroom: document.getElementById("chatroomPage") // ADD THIS LINE
};


    // ===========================
    // State Variables
    // ===========================
    var currentCategory = 'all';
    var searchQuery = ''; // SEARCH ADDITION #2

    // ===========================
    // Initialization Function
    // ===========================
    function init() {
    setTimeout(() => {
        var l = document.getElementById("loadingScreen");
        l.style.opacity = "0";

        setTimeout(() => {
            l.style.display = "none";
        }, 500);

    }, 1500);

    createStars();
    renderCategories();
    renderGames();
    setupEvents();
    setupChatroomEvents(); // ADD THIS LINE
}

    // ===========================
    // Create Stars Background
    // ===========================
    function createStars() {
        var bg = document.getElementById("parallaxBg");

        for (var i = 0; i < 100; i++) {
            var s = document.createElement("div");
            s.className = "star";
            s.style.width = Math.random() * 3 + "px";
            s.style.height = s.style.width;
            s.style.left = Math.random() * 100 + "%";
            s.style.top = Math.random() * 100 + "%";
            s.style.animationDelay = Math.random() * 5 + "s";

            bg.appendChild(s);
        }
    }

    // ===========================
    // Show Page Function
    // ===========================
   function showPage(name) {
    for (var k in pages) {
        if (pages[k]) pages[k].classList.add("hidden");
    }

    if (pages[name]) pages[name].classList.remove("hidden");

    document.querySelectorAll("[data-page]").forEach(l => {
        l.classList.remove("active");
        if (l.getAttribute("data-page") === name) l.classList.add("active");
    });

    document.getElementById("mobileMenu").classList.add("hidden");
    window.scrollTo({ top: 0, behavior: "smooth" });
    
    // Initialize Firebase when entering chatroom
    if (name === 'chatroom' && !isFirebaseInitialized) {
        initFirebase();
    }
}

    // ===========================
    // Render Categories
    // ===========================
    function renderCategories() {
        if (typeof GAMES === 'undefined') return;

        var cats = ['all'];
        GAMES.forEach(g => {
            if (cats.indexOf(g.category) === -1) cats.push(g.category);
        });

        var html = '';
        cats.forEach(cat => {
            var active = cat === currentCategory ? 'active' : '';
            var label = cat === 'all' ? 'All Games' : cat;
            html += '<button class="cat-btn ' + active + '" onclick="filterCategory(\'' + cat + '\')">' + label + '</button>';
        });

        document.getElementById("categoryFilter").innerHTML = html;
    }

    // ===========================
    // Filter Category
    // ===========================
    function filterCategory(cat) {
        currentCategory = cat;
        renderCategories();
        renderGames();
    }

    // ===========================
    // Render Games
    // ===========================
    function renderGames() {
        if (typeof GAMES === 'undefined') {
            document.getElementById("gamesGrid").innerHTML =
                '<p class="text-gray-400 col-span-full text-center">No games found. Check games.js file.</p>';
            return;
        }

        var filtered = GAMES.filter(g => {
            var matchesCat = currentCategory === 'all' || g.category === currentCategory;
            var matchesSearch = searchQuery === '' || (g.title || g.name || '').toLowerCase().includes(searchQuery.toLowerCase());
            return matchesCat && matchesSearch;
        });

        var html = '';
        filtered.forEach(g => {
            var idx = GAMES.indexOf(g);
            var img = g.image || 'https://via.placeholder.com/400x200/1e293b/3b82f6?text=' + encodeURIComponent(g.title || g.name);

            html += '<div class="game-card glassmorphism rounded-2xl overflow-hidden" onclick="playGame(' + idx + ')">';
            html += '<div class="relative overflow-hidden">';
            html += '<img src="' + img + '" alt="' + (g.title || g.name) + '" class="w-full h-48 object-cover">';
            html += '<div class="absolute top-4 right-4"><span class="bg-primary/80 text-white px-3 py-1 rounded-full text-xs">' + g.category + '</span></div>';
            html += '<div class="play-overlay"><div class="play-icon"><i class="fas fa-play"></i></div></div>';
            html += '</div>';
            html += '<div class="p-6">';
            html += '<h3 class="text-xl font-semibold mb-2">' + (g.title || g.name) + '</h3>';
            html += '<p class="text-gray-400 text-sm mb-4">' + (g.description || '') + '</p>';
            html += '<span class="text-primary font-semibold">Play Now ‚Üí</span>';
            html += '</div></div>';
        });

        document.getElementById("gamesGrid").innerHTML = html;
    }

    // ===========================
    // Play Game
    // ===========================
    function playGame(i) {
        var g = GAMES[i];
        if (!g) return;

        sessionStorage.setItem('currentGame', JSON.stringify(g));
        window.location.href = 'play.html';
    }

    // ===========================
    // Send Chat
    // ===========================
async function sendChat() {
    const input = document.getElementById("chatInput");
    const msg = input.value.trim();
    if (!msg) return;

    addMessage(msg, "user");
    input.value = "";

    const typingIndicator = document.getElementById("typingIndicator");
    typingIndicator.classList.remove("hidden");

    // Create a container for the AI response
    const c = document.getElementById("chatMessages");
    const t = document.getElementById("typingIndicator");
    const aiDiv = document.createElement("div");
    aiDiv.className = "flex items-start";
   aiDiv.innerHTML =
    '<div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center"><i class="fas fa-robot text-sm"></i></div>' +
    '<div class="ml-3"><div class="chat-bubble-ai p-4 max-w-md"><p class="streamText"></p></div></div>';;
    c.insertBefore(aiDiv, t);
    const streamText = aiDiv.querySelector(".streamText");

    try {
        const response = await fetch(HF_API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt: msg, max_tokens: 300 })
        });

        // Stream the response!
        const reader = response.body.getReader();
        const decoder = new TextDecoder();
        let done = false;

        while (!done) {
            const { value, done: doneReading } = await reader.read();
            done = doneReading;
            const chunk = decoder.decode(value);
            streamText.textContent += chunk; // append chunk to div
            c.scrollTop = c.scrollHeight;
        }

    } catch (err) {
        console.error(err);
        addMessage("Oops! Something went wrong with the AI.", "ai");
    } finally {
        typingIndicator.classList.add("hidden");
    }
}

    // ===========================
    // Add Chat Message
    // ===========================
    function addMessage(text, sender) {
        var c = document.getElementById("chatMessages");
        var t = document.getElementById("typingIndicator");
        var d = document.createElement("div");

        d.className = "flex items-start " + (sender === "user" ? "justify-end" : "");

        if (sender === "user") {
            d.innerHTML =
                '<div class="mr-3"><div class="chat-bubble-user p-4 max-w-md"><p>' + text + '</p></div></div>' +
                '<div class="w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center"><i class="fas fa-user text-sm"></i></div>';
        } else {
            d.innerHTML =
                '<div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center"><i class="fas fa-robot text-sm"></i></div>' +
                '<div class="ml-3"><div class="chat-bubble-ai p-4 max-w-md"><p>' + text + '</p></div></div>';
        }

        c.insertBefore(d, t);
        c.scrollTop = c.scrollHeight;
    }

    // ===========================
    // Setup Event Listeners
    // ===========================
	// ===========================
// ADMIN SYSTEM
// ===========================
const ADMIN_USERNAME = "synapseadmin"; // Change this to YOUR username
const ADMIN_PASSWORD = "PingZingBlingBling"; // Change this to YOUR password
let isAdmin = false;
let deleteModeActive = false;

function adminLogin() {
    const username = prompt('Enter admin username:');
    
    if (!username) return;
    
    if (username.toLowerCase() !== ADMIN_USERNAME.toLowerCase()) {
        alert('‚ùå Invalid username!');
        return;
    }
    
    const password = prompt('Enter admin password:');
    
    if (!password) return;
    
    if (password !== ADMIN_PASSWORD) {
        alert('‚ùå Wrong password!');
        return;
    }
    
    // Login successful
    isAdmin = true;
    alert('‚úÖ Admin access granted!');
    
    // Update button
    document.getElementById('adminLoginBtn').innerHTML = '<i class="fas fa-crown mr-1"></i>Admin Panel';
    document.getElementById('adminLoginBtn').classList.remove('bg-red-500/20', 'hover:bg-red-500/30');
    document.getElementById('adminLoginBtn').classList.add('bg-yellow-500/30', 'hover:bg-yellow-500/40');
    document.getElementById('adminLoginBtn').onclick = openAdminPanel;
    
    // Mark user as admin
    currentUser.nickname = 'üëë ' + currentUser.nickname;
    document.getElementById('currentNickname').textContent = currentUser.nickname;
    
    console.log('Admin logged in');
}

function openAdminPanel() {
    if (!isAdmin) {
        alert('‚õî Access denied!');
        return;
    }
    
    document.getElementById('adminPanel').classList.remove('hidden');
    updateAdminStats();
}

function closeAdminPanel() {
    document.getElementById('adminPanel').classList.add('hidden');
    if (deleteModeActive) {
        toggleDeleteMode();
    }
}

function updateAdminStats() {
    presenceRef.once('value', (snapshot) => {
        document.getElementById('adminOnlineCount').textContent = snapshot.numChildren();
    });
    
    messagesRef.once('value', (snapshot) => {
        document.getElementById('adminTotalMessages').textContent = snapshot.numChildren();
    });
}

function deleteAllMessages() {
    if (!isAdmin) {
        alert('‚õî Access denied!');
        return;
    }
    
    const confirm = prompt('‚ö†Ô∏è WARNING: This will delete ALL messages!\n\nType "DELETE ALL" to confirm:');
    
    if (confirm !== 'DELETE ALL') {
        alert('Cancelled.');
        return;
    }
    
    messagesRef.remove()
        .then(() => {
            alert('‚úÖ All messages deleted!');
            document.getElementById('chatroomMessages').innerHTML = '<div class="text-center text-gray-500 py-8"><p>All messages cleared by admin.</p></div>';
            updateAdminStats();
        })
        .catch((error) => {
            console.error('Delete error:', error);
            alert('‚ùå Failed to delete messages.');
        });
}

function toggleDeleteMode() {
    if (!isAdmin) {
        alert('‚õî Access denied!');
        return;
    }
    
    deleteModeActive = !deleteModeActive;
    const btn = document.getElementById('deleteMode');
    
    if (deleteModeActive) {
        btn.innerHTML = '<i class="fas fa-times-circle mr-2"></i>Disable Delete Mode';
        btn.classList.remove('bg-orange-600', 'hover:bg-orange-700');
        btn.classList.add('bg-green-600', 'hover:bg-green-700');
        alert('üéØ Delete mode ACTIVE\n\nClick any message to delete it.');
    } else {
        btn.innerHTML = '<i class="fas fa-mouse-pointer mr-2"></i>Enable Delete Mode (Click Messages to Delete)';
        btn.classList.remove('bg-green-600', 'hover:bg-green-700');
        btn.classList.add('bg-orange-600', 'hover:bg-orange-700');
    }
}

function deleteSpecificMessage(messageId) {
    if (!isAdmin || !deleteModeActive) {
        return;
    }
    
    if (!confirm('Delete this message?')) {
        return;
    }
    
    messagesRef.child(messageId).remove()
        .then(() => {
            console.log('Message deleted:', messageId);
            updateAdminStats();
        })
        .catch((error) => {
            console.error('Delete error:', error);
            alert('‚ùå Failed to delete message.');
        });
}
    function setupEvents() {
        document.querySelectorAll("[data-page]").forEach(l => {
            l.addEventListener("click", function(e) {
                e.preventDefault();
                showPage(this.getAttribute("data-page"));
            });
        });

        document.getElementById("mobileMenuBtn").addEventListener("click", () => {
            document.getElementById("mobileMenu").classList.toggle("hidden");
        });

        document.getElementById("tryAI").addEventListener("click", () => {
            showPage("chat");
        });

        document.getElementById("sendMessage").addEventListener("click", sendChat);

        document.getElementById("chatInput").addEventListener("keypress", e => {
            if (e.key === "Enter") sendChat();
        });

        document.getElementById("gameSearch").addEventListener("input", e => {
            searchQuery = e.target.value;
            renderGames();
        });
    } // SEARCH ADDITION #3
// ===========================
// FIREBASE CONFIGURATION
// ===========================
const firebaseConfig = {
  apiKey: "AIzaSyB4p6X2u5thYySUjgCnjQeYZYQ87xg-xds",
  authDomain: "chatroom-f1e6b.firebaseapp.com",
  databaseURL: "https://chatroom-f1e6b-default-rtdb.firebaseio.com",
  projectId: "chatroom-f1e6b",
  storageBucket: "chatroom-f1e6b.firebasestorage.app",
  messagingSenderId: "663028089072",
  appId: "1:663028089072:web:04f2706fd3f5badf334235",
  measurementId: "G-ZT0KHEJ77Y"
};

let firebaseApp, database, messagesRef, presenceRef, userPresenceRef;
let currentUser = { nickname: '', id: '' };
let lastMessageTime = 0;
let userMessageCount = 0;
let isFirebaseInitialized = false;

const badWords = [];

function initFirebase() {
    if (isFirebaseInitialized) return;
    
    try {
        firebaseApp = firebase.initializeApp(firebaseConfig);
        database = firebase.database();
        messagesRef = database.ref('chatroom/messages');
        presenceRef = database.ref('chatroom/presence');
        
        isFirebaseInitialized = true;
        console.log('Firebase initialized');
        
        setupUser();
        listenToMessages();
        setupPresence();
        
        document.getElementById('chatroomStatus').textContent = 'Connected ‚Ä¢ Ready to chat!';
    } catch (error) {
        console.error('Firebase init error:', error);
        document.getElementById('chatroomStatus').textContent = 'Connection failed. Please refresh.';
    }
}

function setupUser() {
    currentUser.id = localStorage.getItem('chatroomUserId');
    if (!currentUser.id) {
        currentUser.id = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('chatroomUserId', currentUser.id);
    }
    
    currentUser.nickname = localStorage.getItem('chatroomNickname');
    if (!currentUser.nickname) {
        promptForNickname();
    } else {
        document.getElementById('currentNickname').textContent = currentUser.nickname;
    }
    
    userMessageCount = parseInt(localStorage.getItem('userMessageCount') || '0');
    document.getElementById('userMessageCount').textContent = userMessageCount;
}

function promptForNickname() {
    let nickname = prompt('Enter your nickname (3-20 characters):');
    
    if (!nickname) {
        nickname = 'Guest' + Math.floor(Math.random() * 9999);
    }
    
    nickname = nickname.trim().substring(0, 20);
    nickname = filterProfanity(nickname);
    
    if (nickname.length < 3) {
        nickname = 'Guest' + Math.floor(Math.random() * 9999);
    }
    
    currentUser.nickname = nickname;
    localStorage.setItem('chatroomNickname', nickname);
    document.getElementById('currentNickname').textContent = nickname;
}

function changeNickname() {
    localStorage.removeItem('chatroomNickname');
    promptForNickname();
}

function setupPresence() {
    userPresenceRef = presenceRef.child(currentUser.id);
    
    userPresenceRef.set({
        nickname: currentUser.nickname,
        online: true,
        lastSeen: firebase.database.ServerValue.TIMESTAMP
    });
    
    userPresenceRef.onDisconnect().remove();
    
    presenceRef.on('value', (snapshot) => {
        const count = snapshot.numChildren();
        document.getElementById('onlineCount').textContent = count;
    });
}

function listenToMessages() {
    document.getElementById('chatroomMessages').innerHTML = '';
    
    messagesRef.orderByChild('timestamp').limitToLast(50).on('child_added', (snapshot) => {
        const msg = snapshot.val();
        msg.id = snapshot.key; // Store the message ID
        displayMessage(msg);
        updateTotalCount();
    });
    
    // Add click listener for delete mode
    document.getElementById('chatroomMessages').addEventListener('click', (e) => {
        if (!isAdmin || !deleteModeActive) return;
        
        const bubble = e.target.closest('.chat-bubble-user, .chat-bubble-ai');
        if (!bubble) return;
        
        const messageDiv = e.target.closest('[data-message-id]');
        if (!messageDiv) return;
        
        const messageId = messageDiv.getAttribute('data-message-id');
        if (messageId) {
            deleteSpecificMessage(messageId);
        }
    });
    
    // Auto-delete messages older than 30 minutes
    cleanupOldMessages();
}

function cleanupOldMessages() {
    const thirtyMinutesAgo = Date.now() - (30 * 60 * 1000); // 30 minutes in milliseconds
    
    messagesRef.orderByChild('timestamp').endAt(thirtyMinutesAgo).once('value', (snapshot) => {
        const updates = {};
        snapshot.forEach((child) => {
            updates[child.key] = null; // Mark for deletion
        });
        
        // Delete old messages
        if (Object.keys(updates).length > 0) {
            messagesRef.update(updates);
            console.log('Cleaned up ' + Object.keys(updates).length + ' old messages');
        }
    });
    
    // Run cleanup every 5 minutes
    setInterval(() => {
        const thirtyMinutesAgo = Date.now() - (30 * 60 * 1000);
        
        messagesRef.orderByChild('timestamp').endAt(thirtyMinutesAgo).once('value', (snapshot) => {
            const updates = {};
            snapshot.forEach((child) => {
                updates[child.key] = null;
            });
            
            if (Object.keys(updates).length > 0) {
                messagesRef.update(updates);
                console.log('Auto-cleanup: Removed ' + Object.keys(updates).length + ' messages');
            }
        });
    }, 5 * 60 * 1000); // Check every 5 minutes
}

function displayMessage(msg) {
    const container = document.getElementById('chatroomMessages');
    const isOwn = msg.userId === currentUser.id;
    
    const msgDiv = document.createElement('div');
    msgDiv.className = 'flex items-start ' + (isOwn ? 'justify-end' : '');
    msgDiv.setAttribute('data-message-id', msg.id || ''); // Store message ID
    
    const time = new Date(msg.timestamp).toLocaleTimeString('en-US', { 
        hour: 'numeric', 
        minute: '2-digit' 
    });
    
    if (isOwn) {
        msgDiv.innerHTML = `
            <div class="text-right mr-3 max-w-md">
                <div class="flex items-center justify-end mb-1">
                    <span class="text-xs text-gray-500 mr-2">${time}</span>
                    <span class="text-sm font-semibold text-primary">${escapeHtml(msg.nickname)}</span>
                </div>
                <div class="chat-bubble-user p-3 ${deleteModeActive && isAdmin ? 'cursor-pointer hover:ring-2 hover:ring-red-500' : ''}">
                    <p class="text-sm">${escapeHtml(msg.text)}</p>
                </div>
            </div>
            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center flex-shrink-0">
                <i class="fas fa-user text-xs"></i>
            </div>
        `;
    } else {
        msgDiv.innerHTML = `
            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0">
                <i class="fas fa-user text-xs"></i>
            </div>
            <div class="ml-3 max-w-md">
                <div class="flex items-center mb-1">
                    <span class="text-sm font-semibold text-secondary">${escapeHtml(msg.nickname)}</span>
                    <span class="text-xs text-gray-500 ml-2">${time}</span>
                </div>
                <div class="chat-bubble-ai p-3 ${deleteModeActive && isAdmin ? 'cursor-pointer hover:ring-2 hover:ring-red-500' : ''}">
                    <p class="text-sm">${escapeHtml(msg.text)}</p>
                </div>
            </div>
        `;
    }
    
    container.appendChild(msgDiv);
    container.scrollTop = container.scrollHeight;
}

function sendChatroomMessage() {
    const input = document.getElementById('chatroomInput');
    const btn = document.getElementById('sendChatroomMessage');
    const text = input.value.trim();
    
    if (!text) return;
    
    const now = Date.now();
    if (now - lastMessageTime < 2000) {
        alert('Please wait a moment before sending another message.');
        return;
    }
    
    const filtered = filterProfanity(text);
    
    btn.disabled = true;
    
    messagesRef.push({
        userId: currentUser.id,
        nickname: currentUser.nickname,
        text: filtered,
        timestamp: firebase.database.ServerValue.TIMESTAMP
    }).then(() => {
        input.value = '';
        lastMessageTime = now;
        
        userMessageCount++;
        localStorage.setItem('userMessageCount', userMessageCount);
        document.getElementById('userMessageCount').textContent = userMessageCount;
        
        setTimeout(() => {
            btn.disabled = false;
        }, 2000);
    }).catch(error => {
        console.error('Send error:', error);
        alert('Failed to send message. Please try again.');
        btn.disabled = false;
    });
}

function updateTotalCount() {
    messagesRef.once('value', (snapshot) => {
        document.getElementById('totalMessageCount').textContent = snapshot.numChildren();
    });
}

function filterProfanity(text) {
    let filtered = text;
    badWords.forEach(word => {
        const regex = new RegExp(word, 'gi');
        filtered = filtered.replace(regex, '*'.repeat(word.length));
    });
    return filtered;
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function setupChatroomEvents() {
    document.getElementById('sendChatroomMessage').addEventListener('click', sendChatroomMessage);
    
    document.getElementById('chatroomInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendChatroomMessage();
    });
}

// ===========================
// DOM Ready
// ===========================
document.addEventListener("DOMContentLoaded", init);
    // ===========================
    // DOM Ready
    // ===========================
    document.addEventListener("DOMContentLoaded", init);

</script>
